CREATE OR REPLACE VIEW v_dinf_clinical_trial_imp01 (
    trial_no,
    active_substance_code,
    baselined_flag,
    distribution_transfer_flag,
    trial_alias_code,
    portable_module_flag,
    planning_module_flag,
    owner,
    clinical_pharm_med_unit_code,
    concept_trial_no,
    data_management_med_unit_code,
    department_code,
    dispensing_med_unit_code,
    forecast_upd_med_unit_code,
    finance_med_unit_code,
    geographical_region_code,
    clinical_duration_months,
    primary_study_med_unit_code,
    protocol_med_unit_code,
    reporting_med_unit_code,
    trial_approved_by,
    isf_confirmed_by,
    isf_confirmed_date,
    isf_required_docs_created_date,
    monitoring_interval_days,
    pc_file_name,
    plan_exported_by,
    portable_module_recorded_by,
    portable_module_recorded_date,
    plan_exported_date,
    protocol_doc_extension,
    protocol_doc_name,
    statistics_duration_months,
    reporting_duration_months,
    pre_trial_duration_months,
    template_no,
    previous_owner,
    clinical_plan_alias_code,
    enrollment_start_end_ind,
    enroll_bdown_last_gen_date,
    enrollment_breakdown_type,
    concept_trial_flag,
    md_template_no,
    probability_factor,
    tvr_confirmed_by,
    tvr_confirmed_date,
    enrollment_baselined_flag,
    enroll_breakdown_start_date_o,
    enroll_breakdown_end_date_o,
    enroll_breakdown_start_date_b,
    enroll_breakdown_end_date_b,
    patient_sequence_ind,
    single_unit_integrated_trial,
    protocol_title,
    tp_last_updated_date,
    gma_flag,
    third_party_indicator,
    CASE_NON_INTEGRATED_IN
) AS
SELECT DISTINCT
        study_nvs.trial_no,
        study_nvs.compound_code AS active_substance_code,
        NULL AS baselined_flag,
        NULL AS distribution_transfer_flag,
        study_nvs.study_code_alias AS trial_alias_code,
        NULL AS portable_module_flag,
        NULL AS planning_module_flag,
        NULL AS owner,
        NULL AS clinical_pharm_med_unit_code,
        NULL AS concept_trial_no,
        NULL AS data_management_med_unit_code,
        study_nvs.study_category_code AS department_code,
        NULL AS dispensing_med_unit_code,
        NULL AS forecast_upd_med_unit_code,
        NULL AS finance_med_unit_code,
        NULL AS geographical_region_code,
        NULL AS clinical_duration_months,
        NULL AS primary_study_med_unit_code,
        NULL AS protocol_med_unit_code,
        NULL AS reporting_med_unit_code,
        NULL AS trial_approved_by,
        NULL AS isf_confirmed_by,
        NULL AS isf_confirmed_date,
        NULL AS isf_required_docs_created_date,
        NULL AS monitoring_interval_days,
        NULL AS pc_file_name,
        NULL AS plan_exported_by,
        NULL AS portable_module_recorded_by,
        NULL AS portable_module_recorded_date,
        NULL AS plan_exported_date,
        NULL AS protocol_doc_extension,
        NULL AS protocol_doc_name,
        NULL AS statistics_duration_months,
        NULL AS reporting_duration_months,
        NULL AS pre_trial_duration_months,
        NULL AS template_no,
        NULL AS previous_owner,
        study_nvs.project_code_alias AS clinical_plan_alias_code,
        NULL AS enrollment_start_end_ind,
        NULL AS enroll_bdown_last_gen_date,
        NULL AS enrollment_breakdown_type,
        NULL AS concept_trial_flag,
        NULL AS md_template_no,
        NULL AS probability_factor,
        NULL AS tvr_confirmed_by,
        NULL AS tvr_confirmed_date,
        NULL AS enrollment_baselined_flag,
        NULL AS enroll_breakdown_start_date_o,
        NULL AS enroll_breakdown_end_date_o,
        NULL AS enroll_breakdown_start_date_b,
        NULL AS enroll_breakdown_end_date_b,
        NULL AS patient_sequence_ind,
        NULL AS single_unit_integrated_trial,
        study_nvs.title protocol_title,
        SYSDATE,
        esb_v_study_gma.item_value gma_flag,
        esb_v_study_non.item_value third_party_indicator,
        DECODE(upper(esb_v_study_non.item_value),'3RD PARTY LOCAL NON-INTEGRATED','Yes','3RD PARTY INTL NON-INTEGRATED','Yes','3RD PARTY INTL INTEGRATED'
,'Yes','3RD PARTY LOCAL INTEGRATED','Yes','3RD PARTY - LOCAL','Yes','3RD PARTY - INTERNATIONAL','Yes','No') CASE_NON_INTEGRATED_IN
    FROM
        study_nvs,
        (
            SELECT
                trial_no,
                item_name,
                item_value
            FROM
                study_userdef_item_nvs study_userdef_item_nvs
            WHERE
                upper(item_name) = 'GMA FLAG'
        ) esb_v_study_gma,
        (
            SELECT
                trial_no,
                item_name,
                item_value
            FROM
                study_userdef_item_nvs study_userdef_item_nvs
            WHERE
                upper(item_name) = 'THIRD PARTY INDICATOR'
                AND   upper(item_value) IN (
                    '3RD PARTY INTL NON-INTEGRATED',
                    '3RD PARTY LOCAL NON-INTEGRATED',
                    '3RD PARTY INTL INTEGRATED',
                    '3RD PARTY LOCAL INTEGRATED',
                    '3RD PARTY - LOCAL',
                    '3RD PARTY - INTERNATIONAL'
                )
        ) esb_v_study_non
    WHERE
        study_nvs.trial_no = esb_v_study_gma.trial_no (+)
        AND   study_nvs.trial_no = esb_v_study_non.trial_no (+);